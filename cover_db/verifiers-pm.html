<!DOCTYPE html
     PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
     "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<!--
This file was generated by Devel::Cover Version 1.36
Devel::Cover is copyright 2001-2019, Paul Johnson (paul@pjcj.net)
Devel::Cover is free. It is licensed under the same terms as Perl itself.
The latest version of Devel::Cover should be available from my homepage:
http://www.pjcj.net
-->
<head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8"></meta>
    <meta http-equiv="Content-Language" content="en-us"></meta>
    <link rel="stylesheet" type="text/css" href="cover.css"></link>
    <link rel="stylesheet" type="text/css" href="cover.css"></link>
    <title>File Coverage: verifiers.pm</title>
</head>
<body>
<h1>File Coverage</h1>
<table>
<tr><td class="h" align="right">File:</td><td align="left">verifiers.pm</td></tr>
<tr><td class="h" align="right">Coverage:</td><td align="left" class="c1">75.2%</td></tr>
</table>
<div><br/></div>
<table>
<tr><th>line</th><th>stmt</th><th>bran</th><th>cond</th><th>sub</th><th>time</th><th>code</th></tr>
<tr><td class="h">1</td><td></td><td></td><td></td><td></td><td></td><td class="s">package verifiers;</td></tr>
<tr><td class="h">2</td><td colspan="6"></td></tr><tr><td class="h">3</td><td><div class="c3">15</div><div class="c3">15</div><div class="c3">15</div></td><td></td><td></td><td><div class="c3"><a href="verifiers-pm--subroutine.html#L3">15</a></div></td><td><div>184</div><div>46</div><div>19123</div></td><td class="s">use MIME::Base64;</td></tr>
<tr><td class="h">4</td><td colspan="6"></td></tr><tr><td class="h">5</td><td></td><td></td><td></td><td></td><td></td><td class="s">sub sqlInjection{</td></tr>
<tr><td class="h">6</td><td><div class="c3">81</div></td><td></td><td></td><td><div class="c3"><a href="verifiers-pm--subroutine.html#L6">81</a></div></td><td><div>143</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;my $argument = $_[0];</td></tr>
<tr><td class="h">7</td><td><div class="c3">81</div></td><td><div class="c3" title="T/F"><a href="verifiers-pm--branch.html#L7">100</a></div></td><td></td><td></td><td><div>228</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return 0 if(! defined $argument);</td></tr>
<tr><td class="h">8</td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;#print(&quot;SEARCHING FOR SQL INJECTIONS ON $argument\n&quot;);</td></tr>
<tr><td class="h">9</td><td><div class="c3">59</div></td><td></td><td></td><td></td><td><div>379</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;@array_sql_expressions = (&#39;SELECT &#39;,&#39; \* &#39;,&#39; FROM &#39;,&#39;DELETE &#39;,&#39;CREATE &#39;,&#39;TRANSACTION &#39;,&#39;BEGIN &#39;,&#39;USING &#39;,&#39;ON &#39;,&#39;AND &#39;,&#39;NOT &#39;,&#39;MATCHED &#39;,&#39;THEN &#39;,&#39;UPDATE &#39;,&#39;MERGE &#39;,&#39;INTO &#39;,&#39;SET &#39;,&#39;INSERT &#39;,&#39;WHERE &#39;,&#39;\&quot;&#39;,&#39;DROP &#39;,&#39; END&#39;);</td></tr>
<tr><td class="h">10</td><td><div class="c3">59</div><div class="c3">1298</div></td><td><div class="c0" title="-/F"><a href="verifiers-pm--branch.html#L10">50</a></div></td><td></td><td></td><td><div>114</div><div>9141</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;map {return 1 if ($argument =~ /$_/i);} @array_sql_expressions;</td></tr>
<tr><td class="h">11</td><td><div class="c3">59</div></td><td></td><td></td><td></td><td><div>270</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return 0;</td></tr>
<tr><td class="h">12</td><td></td><td></td><td></td><td></td><td></td><td class="s">}</td></tr>
<tr><td class="h">13</td><td colspan="6"></td></tr><tr><td class="h">14</td><td></td><td></td><td></td><td></td><td></td><td class="s">sub xmlInjection{</td></tr>
<tr><td class="h">15</td><td><div class="c3">81</div></td><td></td><td></td><td><div class="c3"><a href="verifiers-pm--subroutine.html#L15">81</a></div></td><td><div>113</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;my $argument = $_[0];</td></tr>
<tr><td class="h">16</td><td><div class="c3">81</div></td><td><div class="c3" title="T/F"><a href="verifiers-pm--branch.html#L16">100</a></div></td><td></td><td></td><td><div>163</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return 0 if(! defined $argument);</td></tr>
<tr><td class="h">17</td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;#print(&quot;SEARCHING FOR XML INJECTIONS ON $argument\n&quot;);</td></tr>
<tr><td class="h">18</td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;# Se o input tiver este padr&Atilde;&pound;o &lt;qualquer coisa&gt; ... &lt;/qualquer coisa&gt; asssumimos ser xml!!</td></tr>
<tr><td class="h">19</td><td><div class="c3">59</div></td><td><div class="c0" title="-/F"><a href="verifiers-pm--branch.html#L19">50</a></div></td><td></td><td></td><td><div>112</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;return 1 if ($argument =~ /&lt;[a-zA-Z]*(&gt;[^(&lt;\/)]*&lt;\/[a-zA-Z]*|\/)?&gt;/);</td></tr>
<tr><td class="h">20</td><td><div class="c3">59</div></td><td></td><td></td><td></td><td><div>196</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;return 0;</td></tr>
<tr><td class="h">21</td><td></td><td></td><td></td><td></td><td></td><td class="s">}</td></tr>
<tr><td class="h">22</td><td colspan="6"></td></tr><tr><td class="h">23</td><td></td><td></td><td></td><td></td><td></td><td class="s">#[1]&nbsp;&nbsp;-f&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;-&gt; ficheiro (verificar tamanho &amp; n&Atilde;&pound;o tem | para fazer pipeline)</td></tr>
<tr><td class="h">24</td><td></td><td></td><td></td><td></td><td></td><td class="s">#[2]&nbsp;&nbsp;-u&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;-&gt; n&Atilde;&ordm;mero de utilizador (apenas n&Atilde;&ordm;meros - indicativo espa&Atilde;&sect;o e 9 digitos)</td></tr>
<tr><td class="h">25</td><td></td><td></td><td></td><td></td><td></td><td class="s">#[3]&nbsp;&nbsp;-p&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;-&gt; pin (n&Atilde;&ordm;mero de tamanho 4)</td></tr>
<tr><td class="h">26</td><td></td><td></td><td></td><td></td><td></td><td class="s">#[4]&nbsp;&nbsp;-otp&nbsp;&nbsp;&nbsp;&nbsp;-&gt; input line code received on selfphone (VAZIO/apenas digitos)</td></tr>
<tr><td class="h">27</td><td></td><td></td><td></td><td></td><td></td><td class="s">#[5]&nbsp;&nbsp;-procId -&gt; Process Id (VAZIO/numeros)</td></tr>
<tr><td class="h">28</td><td></td><td></td><td></td><td></td><td></td><td class="s">#[7]&nbsp;&nbsp;-prod&nbsp;&nbsp;&nbsp;-&gt; escolher prepod ou pod {0,1}</td></tr>
<tr><td class="h">29</td><td colspan="6"></td></tr><tr><td class="h">30</td><td></td><td></td><td></td><td></td><td></td><td class="s">sub input{</td></tr>
<tr><td class="h">31</td><td><div class="c3">9</div><div class="c3">9</div></td><td></td><td></td><td><div class="c3"><a href="verifiers-pm--subroutine.html#L31">9</a></div></td><td><div>19</div><div>99</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;my @args = @{$_[0]};</td></tr>
<tr><td class="h">32</td><td colspan="6"></td></tr><tr><td class="h">33</td><td><div class="c3">9</div></td><td><div class="c0" title="T/-"><a href="verifiers-pm--branch.html#L33">50</a></div></td><td></td><td></td><td><div>42</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if(defined $args[1]){</td></tr>
<tr><td class="h">34</td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;#print(&quot;a testar phone number!\n&quot;);</td></tr>
<tr><td class="h">35</td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;#Verifica&Atilde;&sect;&Atilde;&pound;o de n&Atilde;&ordm;meros internacionais com indicativo do pais e n&Atilde;&ordm;mero</td></tr>
<tr><td class="h">36</td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;#die &quot;Wrong Phone Number!! The notation is: +XXX NNNNNNNNN\n&quot; unless $args[2] =~ /^\+[0-9]{1,3} [0-9]{4,14}$/;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</td></tr>
<tr><td class="h">37</td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;#Verifica&Atilde;&sect;&Atilde;&pound;o de n&Atilde;&ordm;meros nacionais com indicativo do pais e n&Atilde;&ordm;mero</td></tr>
<tr><td class="h">38</td><td><div class="c3">9</div></td><td><div class="c0" title="-/F"><a href="verifiers-pm--branch.html#L38">50</a></div></td><td></td><td></td><td><div>85</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;die &quot;Wrong Phone Number!! The notation is: +XXX NNNNNNNNN\n&quot; unless $args[1] =~ /^\+351 [0-9]{9}$/;&nbsp;&nbsp;&nbsp;</td></tr>
<tr><td class="h">39</td><td colspan="6"></td></tr><tr><td class="h">40</td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">41</td><td><div class="c3">9</div></td><td><div class="c0" title="T/-"><a href="verifiers-pm--branch.html#L41">50</a></div></td><td></td><td></td><td><div>37</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if(defined $args[2]){</td></tr>
<tr><td class="h">42</td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;#print(&quot;a testar pin!\n&quot;);</td></tr>
<tr><td class="h">43</td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;#Verifica&Atilde;&sect;&Atilde;&pound;o do pin</td></tr>
<tr><td class="h">44</td><td><div class="c3">9</div></td><td><div class="c0" title="-/F"><a href="verifiers-pm--branch.html#L44">50</a></div></td><td></td><td></td><td><div>64</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;die &quot;Wrong Pin!! The notation is a 4-8 number sequence\n&quot; unless $args[2] =~ /^[0-9]{4,8}$/;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</td></tr>
<tr><td class="h">45</td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">46</td><td><div class="c3">9</div></td><td><div class="c0" title="T/-"><a href="verifiers-pm--branch.html#L46">50</a></div></td><td></td><td></td><td><div>42</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if(defined $args[3]){</td></tr>
<tr><td class="h">47</td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;#Verifica&Atilde;&sect;&Atilde;&pound;o da corre&Atilde;&sect;&Atilde;&pound;o do nome/caminho do ficheiro alvo -&gt; serve para impedir pipelining e ficheiros com nomes errados</td></tr>
<tr><td class="h">48</td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;# WHITE LIST</td></tr>
<tr><td class="h">49</td><td><div class="c3">9</div></td><td><div class="c0" title="-/F"><a href="verifiers-pm--branch.html#L49">50</a></div></td><td></td><td></td><td><div>57</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;die &quot;(White List) Do not try to pipeline or use any strange character on the file to be read...\n&quot; unless $args[3] =~ /^[a-zA-Z\.\/\-\%=\&amp;\+\*\(\)\{\}\[\]0-9\?\&#39;&lt;&gt;&Atilde;&iexcl;&Atilde;&nbsp;&Atilde;&pound;&Atilde;&cent;&Atilde;&curren;&Atilde;&copy;&Atilde;&uml;&Atilde;&ordf;&Atilde;&laquo;&Atilde;&shy;&Atilde;&not;&Atilde;&macr;&Atilde;&sup3;&Atilde;&sup2;&Atilde;&acute;&Atilde;&micro;&Atilde;&para;&Atilde;&sup1;&Atilde;&ordm;&Atilde;&raquo;&Atilde;&frac14;&Atilde;&sect;&Atilde;&plusmn;&Atilde;&#129;&Atilde;&#128;&Atilde;&#131;&Atilde;&#130;&Atilde;&#132;&Atilde;&#137;&Atilde;&#136;&Atilde;&#138;&Atilde;&#139;&Atilde;&#141;&Atilde;&#140;&Atilde;&#142;&Atilde;&#143;&Atilde;&#147;&Atilde;&#146;&Atilde;&#149;&Atilde;&#148;&Atilde;&#150;&Atilde;&#154;&Atilde;&#153;&Atilde;&#155;&Atilde;&#156;C&Atilde;&#145; ]+\.pdf$/;</td></tr>
<tr><td class="h">50</td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;# BLACK LIST -&gt; sere para o caso em que n&Atilde;&pound;o se fornece argumento e a string &Atilde;&copy; o nome da op&Atilde;&sect;&Atilde;&pound;o seguinte</td></tr>
<tr><td class="h">51</td><td><div class="c3">9</div></td><td><div class="c0" title="-/F"><a href="verifiers-pm--branch.html#L51">50</a></div></td><td></td><td></td><td><div>61</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;die &quot;(Black List) Do not try to pipeline or use any strange character on the file to be read...\n&quot; unless $args[3] !~ /^(-)?[(u)(p)(otp)(procId)(app)(prod)(d)]{1}$/;</td></tr>
<tr><td class="h">52</td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;#die &quot;(Black List) Do not try to pipeline or use any strange character on the file to be read...&quot; unless $args[1] !~ /[\|;,&#39;?!&quot;\\]/; </td></tr>
<tr><td class="h">53</td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">54</td><td><div class="c3">9</div></td><td><div class="c3" title="T/F"><a href="verifiers-pm--branch.html#L54">100</a></div></td><td></td><td></td><td><div>45</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if(defined $args[5]){</td></tr>
<tr><td class="h">55</td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;#Verifica&Atilde;&sect;&Atilde;&pound;o da corre&Atilde;&sect;&Atilde;&pound;o do nome/caminho do ficheiro alvo -&gt; serve para impedir pipelining e ficheiros com nomes errados</td></tr>
<tr><td class="h">56</td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;# WHITE LIST</td></tr>
<tr><td class="h">57</td><td><div class="c3">3</div></td><td><div class="c0" title="-/F"><a href="verifiers-pm--branch.html#L57">50</a></div></td><td></td><td></td><td><div>10</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;die &quot;(White List) Do not try to pipeline or use any strange character on the file to be read...\n&quot; unless $args[5] =~ /^[a-zA-Z\.\/\-\%\&amp;\+\*\(\)\{\}\[\]0-9\?\&#39;&lt;&gt;&Atilde;&iexcl;&Atilde;&nbsp;&Atilde;&pound;&Atilde;&cent;&Atilde;&curren;&Atilde;&copy;&Atilde;&uml;&Atilde;&ordf;&Atilde;&laquo;&Atilde;&shy;&Atilde;&not;&Atilde;&macr;&Atilde;&sup3;&Atilde;&sup2;&Atilde;&acute;&Atilde;&micro;&Atilde;&para;&Atilde;&sup1;&Atilde;&ordm;&Atilde;&raquo;&Atilde;&frac14;&Atilde;&sect;&Atilde;&plusmn;&Atilde;&#129;&Atilde;&#128;&Atilde;&#131;&Atilde;&#130;&Atilde;&#132;&Atilde;&#137;&Atilde;&#136;&Atilde;&#138;&Atilde;&#139;&Atilde;&#141;&Atilde;&#140;&Atilde;&#142;&Atilde;&#143;&Atilde;&#147;&Atilde;&#146;&Atilde;&#149;&Atilde;&#148;&Atilde;&#150;&Atilde;&#154;&Atilde;&#153;&Atilde;&#155;&Atilde;&#156;C&Atilde;&#145; ]+\.pdf$/;</td></tr>
<tr><td class="h">58</td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;# BLACK LIST -&gt; sere para o caso em que n&Atilde;&pound;o se fornece argumento e a string &Atilde;&copy; o nome da op&Atilde;&sect;&Atilde;&pound;o seguinte</td></tr>
<tr><td class="h">59</td><td><div class="c3">3</div></td><td><div class="c0" title="-/F"><a href="verifiers-pm--branch.html#L59">50</a></div></td><td></td><td></td><td><div>11</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;die &quot;(Black List) Do not try to pipeline or use any strange character on the file to be read...\n&quot; unless $args[5] !~ /^(-)?[(u)(p)(infile)(outfile)(datetime)]{1}$/;</td></tr>
<tr><td class="h">60</td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;#die &quot;(Black List) Do not try to pipeline or use any strange character on the file to be read...&quot; unless $args[1] !~ /[\|;,&#39;?!&quot;\\]/; </td></tr>
<tr><td class="h">61</td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">62</td><td><div class="c3">9</div></td><td><div class="c3" title="T/F"><a href="verifiers-pm--branch.html#L62">100</a></div></td><td></td><td></td><td><div>72</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if(defined $args[6]){</td></tr>
<tr><td class="h">63</td><td><div class="c3">2</div></td><td><div class="c0" title="-/F"><a href="verifiers-pm--branch.html#L63">50</a></div></td><td></td><td></td><td><div>13</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;die &quot;Input data must have the specified format: YYYY-MM-DDThh:mm:ss.mmmmmm\n&quot; unless $args[6] =~ /^\d{4}-\d{2}-\d{2}T\d{2}:\d{2}:\d{2}.\d{6}$/;</td></tr>
<tr><td class="h">64</td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">65</td><td></td><td></td><td></td><td></td><td></td><td class="s">}</td></tr>
<tr><td class="h">66</td><td colspan="6"></td></tr><tr><td class="h">67</td><td></td><td></td><td></td><td></td><td></td><td class="s">sub valid_otp{</td></tr>
<tr><td class="h">68</td><td><div class="c3">8</div></td><td></td><td></td><td><div class="c3"><a href="verifiers-pm--subroutine.html#L68">8</a></div></td><td><div>232</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;my $argument = $_[0];</td></tr>
<tr><td class="h">69</td><td><div class="c3">8</div></td><td><div class="c0" title="T/-"><a href="verifiers-pm--branch.html#L69">50</a></div></td><td></td><td></td><td><div>133</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if(defined($argument)){</td></tr>
<tr><td class="h">70</td><td><div class="c3">8</div></td><td><div class="c0" title="-/F"><a href="verifiers-pm--branch.html#L70">50</a></div></td><td></td><td></td><td><div>373</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;die &quot;Wrong OTP!! The notation is: XXXXXX\n&quot; unless $argument =~ /^[0-9]{6}$/;</td></tr>
<tr><td class="h">71</td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">72</td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;else{</td></tr>
<tr><td class="h">73</td><td><div class="c0">0</div></td><td></td><td></td><td></td><td><div>0</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;die &quot;OTP not defined!\n&quot;</td></tr>
<tr><td class="h">74</td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">75</td><td></td><td></td><td></td><td></td><td></td><td class="s">}</td></tr>
<tr><td class="h">76</td><td colspan="6"></td></tr><tr><td class="h">77</td><td></td><td></td><td></td><td></td><td></td><td class="s">sub valid_processId{</td></tr>
<tr><td class="h">78</td><td><div class="c3">8</div></td><td></td><td></td><td><div class="c3"><a href="verifiers-pm--subroutine.html#L78">8</a></div></td><td><div>25</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;my $argument = $_[0];</td></tr>
<tr><td class="h">79</td><td colspan="6"></td></tr><tr><td class="h">80</td><td><div class="c3">8</div></td><td><div class="c0" title="T/-"><a href="verifiers-pm--branch.html#L80">50</a></div></td><td></td><td></td><td><div>35</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if(defined($argument)){</td></tr>
<tr><td class="h">81</td><td><div class="c3">8</div></td><td><div class="c0" title="-/F"><a href="verifiers-pm--branch.html#L81">50</a></div></td><td></td><td></td><td><div>73</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;die &quot;Wrong ProcessId!! The notation is: XXXXXXXX-XXXX-XXXX-XXXX-XXXXXXXXXXXX.\n&quot; unless $argument =~ /^[a-z0-9]{8}-[a-z0-9]{4}-[a-z0-9]{4}-[a-z0-9]{4}-[a-z0-9]{12}$/;</td></tr>
<tr><td class="h">82</td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">83</td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;else{</td></tr>
<tr><td class="h">84</td><td><div class="c0">0</div></td><td></td><td></td><td></td><td><div>0</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;die &quot;ProcessId not defined!\n&quot;</td></tr>
<tr><td class="h">85</td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">86</td><td></td><td></td><td></td><td></td><td></td><td class="s">}</td></tr>
<tr><td class="h">87</td><td colspan="6"></td></tr><tr><td class="h">88</td><td></td><td></td><td></td><td></td><td></td><td class="s">sub valid_response{</td></tr>
<tr><td class="h">89</td><td><div class="c3">8</div></td><td></td><td></td><td><div class="c3"><a href="verifiers-pm--subroutine.html#L89">8</a></div></td><td><div>21</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;my $argument = $_[0];</td></tr>
<tr><td class="h">90</td><td colspan="6"></td></tr><tr><td class="h">91</td><td><div class="c3">8</div></td><td><div class="c0" title="T/-"><a href="verifiers-pm--branch.html#L91">50</a></div></td><td></td><td></td><td><div>32</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if(defined($argument)){</td></tr>
<tr><td class="h">92</td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;# verifica o tamanho do input recebido</td></tr>
<tr><td class="h">93</td><td><div class="c3">8</div></td><td><div class="c0" title="-/F"><a href="verifiers-pm--branch.html#L93">50</a></div></td><td></td><td></td><td><div>69</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;die &quot;Illegal length found on Response!!\n&quot; unless length($argument) == 560;</td></tr>
<tr><td class="h">94</td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;# verifica a validade de todos os caracteres</td></tr>
<tr><td class="h">95</td><td><div class="c3">8</div></td><td><div class="c0" title="-/F"><a href="verifiers-pm--branch.html#L95">50</a></div></td><td></td><td></td><td><div>636</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;die &quot;Wrong Response!!\n&quot; unless $argument =~ /^[a-zA-Z0-9+\/]+$/;</td></tr>
<tr><td class="h">96</td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">97</td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;else{</td></tr>
<tr><td class="h">98</td><td><div class="c0">0</div></td><td></td><td></td><td></td><td><div>0</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;die &quot;Response not defined!\n&quot;</td></tr>
<tr><td class="h">99</td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">100</td><td></td><td></td><td></td><td></td><td></td><td class="s">}</td></tr>
<tr><td class="h">101</td><td colspan="6"></td></tr><tr><td class="h">102</td><td></td><td></td><td></td><td></td><td></td><td class="s">sub valid_Signature{</td></tr>
<tr><td class="h">103</td><td><div class="c3">8</div></td><td></td><td></td><td><div class="c3"><a href="verifiers-pm--subroutine.html#L103">8</a></div></td><td><div>20</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;my $argument = $_[0];</td></tr>
<tr><td class="h">104</td><td colspan="6"></td></tr><tr><td class="h">105</td><td><div class="c3">8</div></td><td><div class="c0" title="T/-"><a href="verifiers-pm--branch.html#L105">50</a></div></td><td></td><td></td><td><div>39</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if(defined($argument)){</td></tr>
<tr><td class="h">106</td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;# verifica o tamanho do input recebido</td></tr>
<tr><td class="h">107</td><td><div class="c3">8</div></td><td><div class="c0" title="-/F"><a href="verifiers-pm--branch.html#L107">50</a></div></td><td></td><td></td><td><div>35</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;die &quot;Illegal length found on Signature!!\n&quot; unless length($argument) == 512;</td></tr>
<tr><td class="h">108</td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;# verifica a validade de todos os caracteres</td></tr>
<tr><td class="h">109</td><td><div class="c3">8</div></td><td><div class="c0" title="-/F"><a href="verifiers-pm--branch.html#L109">50</a></div></td><td></td><td></td><td><div>87</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;die &quot;Wrong Signature!!\n&quot; unless $argument =~ /^[a-zA-Z0-9+\/]+$/;</td></tr>
<tr><td class="h">110</td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">111</td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;else{</td></tr>
<tr><td class="h">112</td><td><div class="c0">0</div></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;die &quot;Response not defined!\n&quot;</td></tr>
<tr><td class="h">113</td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">114</td><td></td><td></td><td></td><td></td><td></td><td class="s">}</td></tr>
<tr><td class="h">115</td><td colspan="6"></td></tr><tr><td class="h">116</td><td></td><td></td><td></td><td></td><td></td><td class="s">1;</td></tr>
</table>
</body>
</html>
